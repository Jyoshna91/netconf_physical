job file:-
from pyats.easypy import Task
import os

def main(runtime):
    # Define the test script file path
    script_path = os.path.join(os.path.dirname(__file__), 'vlan_config_test.py')

    # Execute the test script
    Task(testscript=script_path).start()

lib file:-

from pyats.topology import loader
from pyats import aetest

class NetworkLibrary:
    @staticmethod
    def get_testbed():
        return loader.load("testbed.yaml")

    @staticmethod
    def connect_to_device(testbed, device_name='n9k1'):
        device = testbed.devices[device_name]
        device.connect(alias='nc', via='netconf')
        return device

    @staticmethod
    def vlan_configuration_request():
        return """
        <?xml version="1.0" encoding="UTF-8"?>
        <nf:rpc message-id="107" xmlns:nf="urn:ietf:params:xml:ns:netconf:base:1.0" xmlns:nxos="http://www.cisco.com/nxos:1.0">
            <nxos:exec-command>
                <nxos:cmd>configure terminal ; vlan 10 ; name TestVLAN ; interface Vlan10 ; ip address 192.168.10.1/24</nxos:cmd>
            </nxos:exec-command>
        </nf:rpc>
        """

    @staticmethod
    def verify_vlan_request():
        return """
        <?xml version="1.0" encoding="UTF-8"?>
        <nf:rpc message-id="108" xmlns:nf="urn:ietf:params:xml:ns:netconf:base:1.0" xmlns:nxos="http://www.cisco.com/nxos:1.0">
            <nxos:exec-command>
                <nxos:cmd>show running-config interface Vlan10</nxos:cmd>
            </nxos:exec-command>
        </nf:rpc>
        """

test case file:-
from pyats import aetest
from network_lib import NetworkLibrary

class VlanConfigTest(aetest.Testcase):

    @aetest.setup
    def setup(self):
        # Load the testbed
        self.testbed = NetworkLibrary.get_testbed()
        # Connect to the device
        self.device = NetworkLibrary.connect_to_device(self.testbed)
        assert self.device.nc.connected, "Failed to connect to device via NETCONF"

    @aetest.test
    def configure_vlan(self):
        # Get the VLAN configuration request
        command_request = NetworkLibrary.vlan_configuration_request()

        # Send the configuration command
        try:
            reply_command = self.device.nc.request(command_request)
            print("Configuration Reply:")
            print(reply_command)
        except Exception as e:
            self.failed(f"Failed to send configuration command: {e}")

    @aetest.test
    def verify_vlan(self):
        # Get the verification request
        verification_request = NetworkLibrary.verify_vlan_request()

        # Send the verification command
        try:
            verification_reply = self.device.nc.request(verification_request)
            print("Verification Reply:")
            print(verification_reply)
        except Exception as e:
            self.failed(f"Failed to send verification command: {e}")

    @aetest.cleanup
    def cleanup(self):
        # Disconnect from the device
        self.device.nc.disconnect()
        print("NETCONF connected after disconnect:", self.device.nc.connected)

if __name__ == "__main__":
    aetest.main()
